"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const noop = function () { };
function runParallel(funcs) {
    return allSettledVoid(funcs.map((func) => func()));
}
exports.runParallel = runParallel;
function allSettledVoid(promises) {
    return allSettled(promises).then(noop);
}
exports.allSettledVoid = allSettledVoid;
/*
like https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled
*/
function allSettled(promises) {
    let firstError;
    return Promise.all(promises.map((promise) => Promise.resolve(promise).catch((error) => {
        if (!firstError) {
            firstError = error;
        }
        return Promise.resolve();
    }))).then((results) => {
        if (firstError) {
            return Promise.reject(firstError);
        }
        else {
            return Promise.resolve(results);
        }
    });
}
exports.allSettled = allSettled;
function collectResults(promises) {
    return allSettled(promises).then((results) => {
        return [].concat(...results);
    });
}
exports.collectResults = collectResults;
